#!/bin/bash

# Configuration
CONFIG_FILE="/home/brainspiller/Documents/hunt/domains_sub.txt"
LOG_FILE="/home/brainspiller/Documents/hunt/logs/subdomain_exploit.log"
TOOLS_DIR="/home/brainspiller/Documents/hunt/SubdomainExploiting"
GO_SCRIPT="$TOOLS_DIR/subdomain-exploiting"

# Check if Go script exists
if [[ ! -f "$GO_SCRIPT" ]]; then
    echo "Go script $GO_SCRIPT not found!"
    exit 1
fi

# Main Script
while IFS= read -r line; do
    domain=$(echo $line | awk '{print $1}')
    program=$(echo $line | awk '{print $2}')

    # Ensure domain and program are not empty
    if [[ -z "$domain" || -z "$program" ]]; then
        echo "Error: Domain or Program is empty, skipping..." | tee -a $LOG_FILE
        continue
    fi

    echo "Checking for potential subdomain takeovers for $domain under $program..." | tee -a $LOG_FILE
    "$GO_SCRIPT" "$domain" "$program" >> $LOG_FILE 2>&1
    if [ $? -eq 0 ]; then
        echo "Finished checking $domain under $program." | tee -a $LOG_FILE
    else
        echo "Error occurred while checking $domain under $program." | tee -a $LOG_FILE
    fi

done < "$CONFIG_FILE"
